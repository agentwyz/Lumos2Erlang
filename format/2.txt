(define force-thunk
    (lambda (th)
        (cond 
            [(thunk-cached? th) (thunk-fv th)]
            [else 
                (let loop ([val ((thunk-fv th))])
                    (cond 
                        [(thunk? val) (loop ((thunk-fv val)))]
                        [else 
                            (set-thunk-fv! th val)
                            (set-thunk-cached?! th #t) 
                            val]))])))